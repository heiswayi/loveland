<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loveland</title>
    <meta name="description" content="Loveland, Colorado, USA — January 2018">
    <meta name="author" content="Heiswayi Nrird">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="header">
        <h1>Loveland</h1>
        <h2>Loveland, Colorado, USA — January 2018</h2>
    </div>
    <div class="gallery" id="gallery"></div>
    <div class="modal" id="modal" onclick="closeModal()">
        <button class="modal-close" onclick="closeModal()" aria-label="Close">&times;</button>
        <button class="modal-nav modal-prev" onclick="event.stopPropagation(); navigateImage(-1)" aria-label="Previous">&#8249;</button>
        <img id="modal-img" src="" alt="" onclick="event.stopPropagation()">
        <button class="modal-nav modal-next" onclick="event.stopPropagation(); navigateImage(1)" aria-label="Next">&#8250;</button>
    </div>
    <div class="footer">
        <p>© Captured with <span style="color: red;">&hearts;</span> by <a href="https://nrird.com">Heiswayi Nrird</a>. All rights reserved.</p>
    </div>

    <script>
        const images = [
            { src: "photos/1.jpg" },
            { src: "photos/10.jpg" },
            { src: "photos/11.jpg" },
            { src: "photos/12.jpg" },
            { src: "photos/13.jpg" },
            { src: "photos/14.jpg" },
            { src: "photos/15.jpg" },
            { src: "photos/16.jpg" },
            { src: "photos/17.jpg" },
            { src: "photos/18.jpg" },
            { src: "photos/19.jpg" },
            { src: "photos/2.jpg" },
            { src: "photos/20.jpg" },
            { src: "photos/21.jpg" },
            { src: "photos/22.jpg" },
            { src: "photos/23.jpg" },
            { src: "photos/24.jpg" },
            { src: "photos/25.jpg" },
            { src: "photos/26.jpg" },
            { src: "photos/27.jpg" },
            { src: "photos/28.jpg" },
            { src: "photos/29.jpg" },
            { src: "photos/3.jpg" },
            { src: "photos/30.jpg" },
            { src: "photos/31.jpg" },
            { src: "photos/32.jpg" },
            { src: "photos/33.jpg" },
            { src: "photos/34.jpg" },
            { src: "photos/35.jpg" },
            { src: "photos/36.jpg" },
            { src: "photos/37.jpg" },
            { src: "photos/38.jpg" },
            { src: "photos/39.jpg" },
            { src: "photos/4.jpg" },
            { src: "photos/40.jpg" },
            { src: "photos/41.jpg" },
            { src: "photos/42.jpg" },
            { src: "photos/43.jpg" },
            { src: "photos/44.jpg" },
            { src: "photos/45.jpg" },
            { src: "photos/5.jpg" },
            { src: "photos/6.jpg" },
            { src: "photos/7.jpg" },
            { src: "photos/8.jpg" },
            { src: "photos/9.jpg" },
        ];

        const gallery = document.getElementById('gallery');
        let currentImageIndex = 0;

        // Create gallery items with lazy loading
        images.forEach((image, index) => {
            const div = document.createElement('div');
            div.className = 'gallery-item';
            // Use data-src for lazy loading instead of src
            div.innerHTML = `<img data-src="${image.src}" class="lazy" alt="Photo ${index + 1}" onclick="openModal(${index})">`;
            gallery.appendChild(div);
        });

        // Intersection Observer for lazy loading with fade effect
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    const src = img.getAttribute('data-src');

                    // Preload the image
                    const tempImg = new Image();
                    tempImg.onload = () => {
                        img.src = src;
                        img.classList.add('loaded');
                        img.removeAttribute('data-src');
                    };
                    tempImg.src = src;

                    observer.unobserve(img);
                }
            });
        }, {
            rootMargin: '50px' // Start loading 50px before image enters viewport
        });

        // Observe all lazy images
        document.querySelectorAll('img.lazy').forEach(img => {
            imageObserver.observe(img);
        });

        function openModal(index) {
            currentImageIndex = index;
            const modal = document.getElementById('modal');
            const modalImg = document.getElementById('modal-img');
            modal.classList.add('active');
            modalImg.src = images[index].src;
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
            document.body.style.overflow = ''; // Restore scrolling
        }

        function navigateImage(direction) {
            currentImageIndex += direction;
            if (currentImageIndex < 0) currentImageIndex = images.length - 1;
            if (currentImageIndex >= images.length) currentImageIndex = 0;

            const modalImg = document.getElementById('modal-img');
            modalImg.style.opacity = '0';

            setTimeout(() => {
                modalImg.src = images[currentImageIndex].src;
                modalImg.style.opacity = '1';
            }, 150);
        }

        // Keyboard navigation
        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') closeModal();
            if (document.getElementById('modal').classList.contains('active')) {
                if (e.key === 'ArrowLeft') navigateImage(-1);
                if (e.key === 'ArrowRight') navigateImage(1);
            }
        });
    </script>
</body>

</html>